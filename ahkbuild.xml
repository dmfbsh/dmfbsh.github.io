<project name="Compile AHK Scripts" default="deployAHK" basedir=".">
  <description>
    Script to build and deploy the AHK scripts
  </description>

  <!-- set global properties for this build -->
  <property name="src" location="_database"/>
  <property name="dest" location="C:\Users\David\Documents\OneDrive\Documents\My Documents\3. Shropshire\Web Site"/>
  <property name="ahk2exe" location="C:\Program Files\AutoHotkey\Compiler\Ahk2Exe.exe"/>

  <target name="deployAHK">
    <antcall target="ShropshirePhotography"/>
    <antcall target="ShropshireFeatures"/>
    <antcall target="ChurchSubimages"/>
    <copy file="${src}\sqlite3.dll" todir="${dest}"/>
    <copy file="${src}\Shropshire Photography.ini" todir="${dest}"/>
  </target>

  <target name="ShropshirePhotography" depends="chkShropshirePhotography" unless="ShropshirePhotography.isUpToDate">
    <antcall target="compileScript">
      <param name="script" value="Shropshire Photography"/>
    </antcall>
  </target>

  <target name="ShropshireFeatures" depends="chkShropshireFeatures" unless="ShropshireFeatures.isUpToDate">
    <antcall target="compileScript">
      <param name="script" value="Shropshire Features"/>
    </antcall>
  </target>

  <target name="ChurchSubimages" depends="chkChurchSubimages" unless="ChurchSubimages.isUpToDate">
    <antcall target="compileScript">
      <param name="script" value="Church Subimages"/>
    </antcall>
  </target>

  <target name="chkShropshirePhotography">
    <uptodate property="ShropshirePhotography.isUpToDate" srcfile="${src}\Shropshire Photography.ahk" targetfile="${dest}\Shropshire Photography.exe"/>
  </target>

  <target name="chkShropshireFeatures">
    <uptodate property="ShropshireFeatures.isUpToDate" srcfile="${src}\Shropshire Features.ahk" targetfile="${dest}\Shropshire Features.exe"/>
  </target>

  <target name="chkChurchSubimages">
    <uptodate property="ChurchSubimages.isUpToDate" srcfile="${src}\Church Subimages.ahk" targetfile="${dest}\Church Subimages.exe"/>
  </target>

  <target name="compileScript">
    <exec executable="${ahk2exe}">
      <arg value="/in"/>
      <arg value="${src}\${script}.ahk"/>
      <arg value="/out"/>
      <arg value="${dest}\${script}.exe"/>
    </exec>
  </target>

</project>
